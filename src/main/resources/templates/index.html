<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <base th:href="${serverBase}"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" th:href="@{/style.css}"/>
    <script th:src="@{/webapp.js}"></script>
</head>
<body>
<form method="post" th:action="@{/search}">
    <input type="checkbox" id="drawer">
    <label id="drawer-toggle" for="drawer"></label>
    <aside>
        <div class="title">FX Desktop Search</div>
        <a class="item settings" onclick="desktopsearch.configure()">Configure</a>
        <a class="item search" onclick="desktopsearch.completecrawl()">Complete crawl</a>
        <a class="item close" onclick="desktopsearch.close()">Quit / Shutdown</a>
    </aside>

    <div th:if="${queryResult != null}">
        <nav class="search">
            <a th:href="@{/search}"><img th:src="@{/logo.png}"/></a>
            <div class="search-input-wrapper">
                <input th:value="${queryResult.searchTerm}" autocomplete="off" id="querystring" name="querystring" placeholder="Enter searchphrase here...">
                <div id="suggestion" class="hidden">
                </div>
            </div>
            <button type="submit">Search!</button>
        </nav>
    </div>

    <nav role="chips" th:if="${queryResult != null}">
        <div class="chips">
            <a th:each="filter : ${queryResult.activeFilters}"
               th:href="${filter.deleteLink}"
               th:text="${filter.name}">Filter</a>
        </div>
    </nav>

    <nav role="facet" th:if="${queryResult != null}">
        <ul>
            <li th:each="dimension, iterStat : ${queryResult.facetDimensions}">
                <input type="checkbox" th:id="'facet_' + ${iterStat.index}">
                <label th:for="'facet_' + ${iterStat.index}">
                    <a th:text="${dimension.name}">Dimension</a>
                </label>
                <div class="menu">
                    <a th:each="facet : ${dimension.facets}"
                       th:href="${facet.link}"
                       th:text="${facet.name} + ' (' + ${facet.number} + ')'">Facet</a>
                </div>
            </li>
        </ul>
    </nav>

    <div th:if="${queryResult != null}">
        <div class="summarytext">
            The search was processed in <span th:text="${queryResult.elapsedTime}">0</span>ms.,
            searched in <span th:text="${queryResult.totalDocuments}">0</span> documents.
        </div>

        <div class="resultentry" th:each="document : ${queryResult.documents}">
            <div class="image">
                <img class="lazy"
                     src="loading.gif"
                     th:attr="data-filename=${document.fileName}"/>
            </div>
            <div class="text">
                <a class="entrytitle"
                   th:attr="data-filename=${document.fileName}"
                   th:onclick="'desktopsearch.openFile(event)'"
                   th:text="${document.title}">Title</a>

                <a class="filename"
                   th:each="similarFile : ${document.similarFiles}"
                   th:attr="data-filename=${document.fileName}"
                   th:onclick="'desktopsearch.openFile(event)'"
                   th:text="${queryResult.getSimpleFileName(similarFile)}">Similar File</a>

                <div class="starsouter">
                    <th:block th:each="index : ${#numbers.sequence(1, 5)}">
                        <span th:if="${document.normalizedScore >= index}" class="stars-full"></span>
                        <span th:unless="${document.normalizedScore >= index}" class="stars-empty"></span>
                    </th:block>
                </div>
                <div class="entrytext" th:utext="${document.highlightedSearchResult}">Search result</div>
            </div>
        </div>
    </div>

    <div class="welcome" th:unless="${queryResult != null}">
        <div class="logo">
            <img th:src="@{/logo.png}"/>
        </div>
        <div class="search">
            <div class="search-input-wrapper">
                <input autocomplete="off" id="querystring" name="querystring" placeholder="Enter searchphrase here...">
                <div id="suggestion" class="hidden">
                </div>
            </div>
            <button type="submit">Search!</button>
        </div>
        <div class="introduction">
            <div>Search examples:</div>
            <div><mark>scott adams</mark> searches for all documents containing the phrase "scott adams" or at least the words "scott" and "adams" in any order.</div>
            <div><mark>scott adams -dogbert</mark> searches for all documents containing the text "scot adams", but not "dogbert".</div>
            <div><mark>scott ad*</mark> searches for all documents containing the word "scott" and any words matching the wildcard "ad*", where * stands for any number of characters.</div>
            <div><mark>scott ad?ms</mark> searches for all documents containing the word "scott" and any words matching the wildcard "ad?ms", where ? stands for one character.</div>
            <div><mark>scott ~adams</mark> searches for all documents containing the word "scott" and any words matching the fuzzy term "adams".</div>
        </div>
    </div>
</form>
<script>
    desktopsearch.registerSuggest();
</script>
</body>
</html>